{"version":3,"sources":["webpack:///3.7781ca6968da3006c104.js","webpack:///./src/industrywar/components/navbar.vue?0b8b*","webpack:///./src/industrywar/components/navbar.vue?3fd4*","webpack:///./src/industrywar/components/navbar.vue?2a98*","webpack:///./src/industrywar/pages/map.vue?fec9","webpack:///./src/industrywar/pages/map.vue?7881","webpack:///./src/industrywar/pages/map.vue?a4c1","webpack:///./src/industrywar/pages/map.vue?fe2d","webpack:///./src/industrywar/pages/map.vue?5f55","webpack:///./src/industrywar/pages/map.vue?7483","webpack:///./src/industrywar/pages/map.vue"],"names":["webpackJsonp","6","module","exports","methods","toggleSidebar","$","sidebar","7","8","__webpack_require__","__vue_script__","__vue_template__","__esModule","options","template","166","debug","resizer","height","window","innerHeight","data","faild","currentCenter","infoWindow","components","Navbar","reload","location","ready","center","map","AMap","this","Map","mapStyle","zoom","getCenter","InfoWindow","isCustom","offset","Pixel","event","addListener","_this","e","distance","getZoom","findStrongholds","lng","lat","attached","$store","dispatch","resize","detached","off","vuex","getters","loading","state","accounts","actions","store","longitude","latitude","point","query","AV","GeoPoint","Query","near","find","then","posts","i","len","marker","markers","post","results","getAllOverlays","remove","length","get","Marker","position","extData","strongholdObj","setLabel","content","push","on","stronghold","target","getExtData","setContent","id","open","getPosition","187","version","sources","names","mappings","file","sourcesContent","sourceRoot","203","210","locals","226","266","277"],"mappings":"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","file":"3.7781ca6968da3006c104.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ 6:\n/***/ function(module, exports) {\n\n\tmodule.exports = {\n\t  methods: {\n\t    toggleSidebar: function() {\n\t      return $('.ui.sidebar').sidebar('toggle');\n\t    }\n\t  }\n\t};\n\n\n/***/ },\n\n/***/ 7:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div v-show=!isSidebarHidden class=\\\"ui top fixed borderless menu\\\"><a @click=toggleSidebar class=\\\"launch icon item\\\"><slot name=toggleButton><i class=\\\"content icon\\\"></i></slot></a><slot></slot></div>\";\n\n/***/ },\n\n/***/ 8:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__vue_script__ = __webpack_require__(6)\n\t__vue_template__ = __webpack_require__(7)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n\n/***/ 166:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar debug, resizer;\n\t\n\tdebug = __webpack_require__(5)(\"map\");\n\t\n\tresizer = function() {\n\t  $(\"#map-container\").height(window.innerHeight);\n\t  return debug(\"调整窗口尺寸\");\n\t};\n\t\n\tmodule.exports = {\n\t  data: function() {\n\t    return {\n\t      faild: false,\n\t      currentCenter: null,\n\t      infoWindow: null\n\t    };\n\t  },\n\t  components: {\n\t    Navbar: __webpack_require__(8)\n\t  },\n\t  methods: {\n\t    reload: function() {\n\t      return location.reload(true);\n\t    }\n\t  },\n\t  ready: function() {\n\t    var center, map;\n\t    if (typeof AMap === \"undefined\" || AMap === null) {\n\t      this.faild = true;\n\t      return;\n\t    }\n\t    map = new AMap.Map('map-container', {\n\t      mapStyle: 'fresh',\n\t      zoom: 11\n\t    });\n\t    this.currentCenter = map.getCenter();\n\t    this.infoWindow = new AMap.InfoWindow({\n\t      isCustom: false,\n\t      offset: new AMap.Pixel(0, -30)\n\t    });\n\t    AMap.event.addListener(map, \"moveend\", (function(_this) {\n\t      return function(e) {\n\t        var center;\n\t        center = map.getCenter();\n\t        if (center.distance(_this.currentCenter) > 10000 && map.getZoom() > 10) {\n\t          _this.currentCenter = center;\n\t          return _this.findStrongholds(center.lng, center.lat, map);\n\t        }\n\t      };\n\t    })(this));\n\t    center = map.getCenter();\n\t    return this.findStrongholds(center.lng, center.lat, map);\n\t  },\n\t  attached: function() {\n\t    debug(\"激活了地图组件\");\n\t    this.$store.dispatch(\"SET_NAV_TITLE\", \"地图\");\n\t    resizer();\n\t    return $(window).resize(resizer);\n\t  },\n\t  detached: function() {\n\t    debug(\"移除了地图组件\");\n\t    return $(window).off('resize', resizer);\n\t  },\n\t  vuex: {\n\t    getters: {\n\t      loading: function(state) {\n\t        return state.accounts.loading;\n\t      }\n\t    },\n\t    actions: {\n\t      findStrongholds: function(store, longitude, latitude, map) {\n\t        var point, query;\n\t        point = new AV.GeoPoint({\n\t          latitude: latitude,\n\t          longitude: longitude\n\t        });\n\t        query = new AV.Query('Stronghold');\n\t        query.near('location', point);\n\t        return query.find().then((function(_this) {\n\t          return function(posts) {\n\t            var i, len, marker, markers, post, results;\n\t            debug(posts);\n\t            store.dispatch(\"CACHE_STRONGHOLDS\", posts);\n\t            markers = map.getAllOverlays(\"marker\");\n\t            map.remove(markers);\n\t            results = [];\n\t            for (i = 0, len = posts.length; i < len; i++) {\n\t              post = posts[i];\n\t              point = post.get(\"location\");\n\t              marker = new AMap.Marker({\n\t                position: [point.longitude, point.latitude],\n\t                map: map,\n\t                extData: {\n\t                  strongholdObj: post\n\t                }\n\t              });\n\t              marker.setLabel({\n\t                content: post.get('name'),\n\t                offset: new AMap.Pixel(-15, 37)\n\t              });\n\t              results.push(marker.on('click', function(e) {\n\t                var stronghold;\n\t                stronghold = e.target.getExtData().strongholdObj;\n\t                _this.infoWindow.setContent(\"<div class=\\\"ui dividing small header\\\">\" + (stronghold.get('name')) + \"</div> <p class=\\\"description\\\">\" + (stronghold.get('description')) + \"</p> <div class=\\\"extra\\\"> <a class=\\\"ui labeled icon button\\\" onclick=\\\"router.go({name:'stronghold',params:{id:'\" + stronghold.id + \"'}})\\\"> <i class=\\\"sign in icon\\\"></i> 进入 </a> <a class=\\\"ui icon button\\\"> <i class=\\\"info icon\\\"></i> </a> <a class=\\\"ui icon button\\\"> <i class=\\\"empty star icon\\\"></i> </a> <a class=\\\"ui icon button\\\"> <i class=\\\"share alternate icon\\\"></i> </a> </div>\");\n\t                return _this.infoWindow.open(map, e.target.getPosition());\n\t              }));\n\t            }\n\t            return results;\n\t          };\n\t        })(this));\n\t      }\n\t    }\n\t  }\n\t};\n\n\n/***/ },\n\n/***/ 187:\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(2)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \"div.amap-marker-label{background-color:#e8e8e8;padding:.5833em .833em;border:1px solid rgba(34,36,38,.149);border-radius:.28571429rem;color:rgba(0,0,0,.8);opacity:.85}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/map.vue\"],\"names\":[],\"mappings\":\"AAAA,sBACE,yBAA0B,AAC1B,uBAA0B,AAC1B,qCAAuC,AACvC,2BAA6B,AAC7B,qBAAuB,AACvB,WAAc,CACf\",\"file\":\"map.vue\",\"sourcesContent\":[\"div.amap-marker-label {\\n  background-color: #e8e8e8;\\n  padding: 0.5833em 0.833em;\\n  border: 1px solid rgba(34,36,38,0.149);\\n  border-radius: 0.28571429rem;\\n  color: rgba(0,0,0,0.8);\\n  opacity: 0.85;\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\t\n\t// exports\n\n\n/***/ },\n\n/***/ 203:\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(2)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".ui.top.fixed.menu[_v-ad9a783e]{background-color:hsla(0,0%,100%,.9)}#map-container[_v-ad9a783e]{width:100%}#map-container h1[_v-ad9a783e]{color:red;text-align:center}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/map.vue\"],\"names\":[],\"mappings\":\"AAAA,gCACE,mCAAwC,CACzC,AACD,4BAEE,UAAY,CACb,AACD,+BACE,UAAY,AACZ,iBAAmB,CACpB\",\"file\":\"map.vue\",\"sourcesContent\":[\".ui.top.fixed.menu[_v-ad9a783e] {\\n  background-color: rgba(255,255,255,0.9);\\n}\\n#map-container[_v-ad9a783e] {\\n/*margin-top -3em //配合透明导航条*/\\n  width: 100%;\\n}\\n#map-container h1[_v-ad9a783e] {\\n  color: #f00;\\n  text-align: center;\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\t\n\t// exports\n\n\n/***/ },\n\n/***/ 210:\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(187);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(4)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=1!./map.vue\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=1!./map.vue\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n\n/***/ 226:\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(203);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(4)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./map.vue\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./map.vue\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n\n/***/ 266:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div _v-ad9a783e=\\\"\\\"><div class=\\\"ui container\\\" _v-ad9a783e=\\\"\\\"><navbar _v-ad9a783e=\\\"\\\"><a class=item _v-ad9a783e=\\\"\\\">地图</a></navbar><div v-if=faild class=\\\"ui padded grid\\\" _v-ad9a783e=\\\"\\\"><div class=column _v-ad9a783e=\\\"\\\"><div class=\\\"ui error message\\\" _v-ad9a783e=\\\"\\\">地图组件暂时不可用。请稍候<a @click=reload _v-ad9a783e=\\\"\\\">刷新</a>重试。</div></div></div></div><div id=map-container _v-ad9a783e=\\\"\\\"></div></div>\";\n\n/***/ },\n\n/***/ 277:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(226)\n\t__webpack_require__(210)\n\t__vue_script__ = __webpack_require__(166)\n\t__vue_template__ = __webpack_require__(266)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** 3.7781ca6968da3006c104.js\n **/","# <template lang=\"jade\">\n# .ui.top.fixed.borderless.menu(v-show=\"!isSidebarHidden\")\n#   a.launch.icon.item(@click=\"toggleSidebar\")\n#     slot(name=\"toggleButton\")\n#       i.content.icon\n#   slot\n# </template>\n#\n# <script lang=\"coffee\">\nmodule.exports=\n  methods:\n    toggleSidebar:->\n      $('.ui.sidebar').sidebar('toggle')\n\n# </script>\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/vue-loader/lib/selector.js?type=script&index=0!./src/industrywar/components/navbar.vue\n **/","module.exports = \"<div v-show=!isSidebarHidden class=\\\"ui top fixed borderless menu\\\"><a @click=toggleSidebar class=\\\"launch icon item\\\"><slot name=toggleButton><i class=\\\"content icon\\\"></i></slot></a><slot></slot></div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-loader.js?raw&engine=jade!./~/vue-loader/lib/selector.js?type=template&index=0!./src/industrywar/components/navbar.vue\n ** module id = 7\n ** module chunks = 2 3 4 5 6\n **/","var __vue_script__, __vue_template__\n__vue_script__ = require(\"!!coffee!./../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./navbar.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../../node_modules/vue-loader/lib/template-loader.js?raw&engine=jade!./../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./navbar.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/industrywar/components/navbar.vue\n ** module id = 8\n ** module chunks = 2 3 4 5 6\n **/","# <template lang=\"jade\">\n# div\n#   .ui.container\n#     navbar\n#       a.item 地图\n#     .ui.padded.grid(v-if=\"faild\")\n#       .column\n#         .ui.error.message\n#           | 地图组件暂时不可用。请稍候\n#           a(@click = \"reload\") 刷新\n#           | 重试。\n#   #map-container\n#\n# </template>\n#\n# <style lang=\"stylus\" scoped>\n# .ui.top.fixed.menu\n#   background-color: rgba(255,255,255,0.9);\n# #map-container\n#   /*margin-top -3em //配合透明导航条*/\n#   width 100%\n#   h1\n#     color red\n#     text-align center\n# </style>\n#\n# <style lang=\"stylus\">\n# // 全局的一些样式，应用到地图的标签。\n# div.amap-marker-label\n#   background-color: #e8e8e8\n#   padding: .5833em .833em\n#   border: 1px solid rgba(34, 36, 38, 0.14902)\n#   border-radius: .28571429rem\n#   color rgba(0,0,0,.8)\n#   opacity:0.85\n# </style>\n#\n# <script lang=\"coffee\">\ndebug = require(\"debug\")(\"map\")\nresizer = ->\n  $(\"#map-container\").height(window.innerHeight)\n  debug(\"调整窗口尺寸\")\nmodule.exports=\n  data:->\n    faild:false\n    currentCenter:null #默认的中心\n    infoWindow:null\n  components:\n    Navbar:require \"../components/navbar.vue\"\n  methods:\n    reload:->\n      location.reload(true)\n  ready:->\n    if not AMap?\n      # alert \"地图暂时不可用，请稍候重试。\"\n      @faild = true\n      return\n    map = new AMap.Map 'map-container',\n      mapStyle:'fresh'\n      zoom:11\n    @currentCenter = map.getCenter()\n    @infoWindow = new AMap.InfoWindow({\n      isCustom: false#使用自定义窗体\n      offset: new AMap.Pixel(0, -30)\n    })\n    # AMap.event.addListener(map, \"movestart\", (e)=>\n    #   @infoWindow.close() #地图移动的时候关闭信息窗体。因为在移动端有性能问题。\n    # )\n    AMap.event.addListener(map, \"moveend\", (e)=>\n      center = map.getCenter()\n      if center.distance(@currentCenter)>10000 and map.getZoom()>10 #距离大于一定值才进行刷新\n        @currentCenter = center\n        @findStrongholds(center.lng,center.lat,map)\n    )\n    center = map.getCenter()\n    @findStrongholds(center.lng,center.lat,map)# 初始化进行一次查询\n  attached:->\n    debug(\"激活了地图组件\")\n    @$store.dispatch(\"SET_NAV_TITLE\",\"地图\") #设置标题\n    resizer() #调整地图组件尺寸\n    $(window).resize(resizer) #监听窗口缩放事件\n  detached:->\n    debug(\"移除了地图组件\")\n    $(window).off('resize',resizer) #移除监听窗口缩放事件\n  vuex:\n    getters:\n      loading:(state)->\n        state.accounts.loading\n    actions:\n      findStrongholds:(store,longitude,latitude,map)->\n        point = new AV.GeoPoint({latitude,longitude})\n        query = new AV.Query('Stronghold')\n        query.near('location', point)\n        query.find().then((posts)=>\n          debug(posts)\n          store.dispatch(\"CACHE_STRONGHOLDS\",posts) #将获得的据点进行缓存。\n          markers = map.getAllOverlays(\"marker\") #得到当前地图的所有marker\n          map.remove(markers)#删除掉marker（清空）\n          for post in posts\n            point = post.get(\"location\")\n            marker = new AMap.Marker(\n              position:[point.longitude,point.latitude]\n              map:map\n              extData:{strongholdObj:post}\n            )\n            marker.setLabel({content: post.get('name'),offset: new AMap.Pixel(-15, 37)})\n            marker.on('click',(e)=>\n              stronghold = e.target.getExtData().strongholdObj\n              @infoWindow.setContent \"\n                              <div class=\\\"ui dividing small header\\\">#{ stronghold.get('name') }</div>\n                              <p class=\\\"description\\\">#{stronghold.get('description')}</p>\n                              <div class=\\\"extra\\\">\n                                <a class=\\\"ui labeled icon button\\\" onclick=\\\"router.go({name:'stronghold',params:{id:'#{stronghold.id}'}})\\\">\n                                  <i class=\\\"sign in icon\\\"></i>\n                                  进入\n                                </a>\n                                <a class=\\\"ui icon button\\\">\n                                  <i class=\\\"info icon\\\"></i>\n                                </a>\n                                <a class=\\\"ui icon button\\\">\n                                  <i class=\\\"empty star icon\\\"></i>\n                                </a>\n                                <a class=\\\"ui icon button\\\">\n                                  <i class=\\\"share alternate icon\\\"></i>\n                                </a>\n                              </div>\n                              \"\n              @infoWindow.open(map, e.target.getPosition())\n            )\n        )\n\n# </script>\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/vue-loader/lib/selector.js?type=script&index=0!./src/industrywar/pages/map.vue\n **/","exports = module.exports = require(\"./../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"div.amap-marker-label{background-color:#e8e8e8;padding:.5833em .833em;border:1px solid rgba(34,36,38,.149);border-radius:.28571429rem;color:rgba(0,0,0,.8);opacity:.85}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/map.vue\"],\"names\":[],\"mappings\":\"AAAA,sBACE,yBAA0B,AAC1B,uBAA0B,AAC1B,qCAAuC,AACvC,2BAA6B,AAC7B,qBAAuB,AACvB,WAAc,CACf\",\"file\":\"map.vue\",\"sourcesContent\":[\"div.amap-marker-label {\\n  background-color: #e8e8e8;\\n  padding: 0.5833em 0.833em;\\n  border: 1px solid rgba(34,36,38,0.149);\\n  border-radius: 0.28571429rem;\\n  color: rgba(0,0,0,0.8);\\n  opacity: 0.85;\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=1!./src/industrywar/pages/map.vue\n ** module id = 187\n ** module chunks = 3\n **/","exports = module.exports = require(\"./../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".ui.top.fixed.menu[_v-ad9a783e]{background-color:hsla(0,0%,100%,.9)}#map-container[_v-ad9a783e]{width:100%}#map-container h1[_v-ad9a783e]{color:red;text-align:center}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/map.vue\"],\"names\":[],\"mappings\":\"AAAA,gCACE,mCAAwC,CACzC,AACD,4BAEE,UAAY,CACb,AACD,+BACE,UAAY,AACZ,iBAAmB,CACpB\",\"file\":\"map.vue\",\"sourcesContent\":[\".ui.top.fixed.menu[_v-ad9a783e] {\\n  background-color: rgba(255,255,255,0.9);\\n}\\n#map-container[_v-ad9a783e] {\\n/*margin-top -3em //配合透明导航条*/\\n  width: 100%;\\n}\\n#map-container h1[_v-ad9a783e] {\\n  color: #f00;\\n  text-align: center;\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=0!./src/industrywar/pages/map.vue\n ** module id = 203\n ** module chunks = 3\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=1!./map.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=1!./map.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=1!./map.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"extract\":true,\"remove\":true}!./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=1!./src/industrywar/pages/map.vue\n ** module id = 210\n ** module chunks = 3\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./map.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./map.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./../../../node_modules/stylus-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./map.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"extract\":true,\"remove\":true}!./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=0!./src/industrywar/pages/map.vue\n ** module id = 226\n ** module chunks = 3\n **/","module.exports = \"<div _v-ad9a783e=\\\"\\\"><div class=\\\"ui container\\\" _v-ad9a783e=\\\"\\\"><navbar _v-ad9a783e=\\\"\\\"><a class=item _v-ad9a783e=\\\"\\\">地图</a></navbar><div v-if=faild class=\\\"ui padded grid\\\" _v-ad9a783e=\\\"\\\"><div class=column _v-ad9a783e=\\\"\\\"><div class=\\\"ui error message\\\" _v-ad9a783e=\\\"\\\">地图组件暂时不可用。请稍候<a @click=reload _v-ad9a783e=\\\"\\\">刷新</a>重试。</div></div></div></div><div id=map-container _v-ad9a783e=\\\"\\\"></div></div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-rewriter.js?id=_v-ad9a783e!./~/vue-loader/lib/template-loader.js?raw&engine=jade!./~/vue-loader/lib/selector.js?type=template&index=0!./src/industrywar/pages/map.vue\n ** module id = 266\n ** module chunks = 3\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-ad9a783e&scoped=true!stylus-loader?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./map.vue\")\nrequire(\"!!./../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!stylus-loader?sourceMap!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=1!./map.vue\")\n__vue_script__ = require(\"!!coffee!./../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./map.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../../node_modules/vue-loader/lib/template-rewriter.js?id=_v-ad9a783e!./../../../node_modules/vue-loader/lib/template-loader.js?raw&engine=jade!./../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./map.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/industrywar/pages/map.vue\n ** module id = 277\n ** module chunks = 3\n **/"],"sourceRoot":""}