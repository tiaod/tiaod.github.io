{"version":3,"sources":["webpack:///5.c5ffb173f38c614e3cf3.js","webpack:///./src/industrywar/components/navbar.vue?0b8b***","webpack:///./src/industrywar/components/navbar.vue?3fd4***","webpack:///./src/industrywar/components/navbar.vue?2a98***","webpack:///./src/industrywar/pages/accounts/loginWeibo.vue?e6c3","webpack:///./src/industrywar/pages/accounts/loginWeibo.vue?0be8","webpack:///./src/industrywar/pages/accounts/loginWeibo.vue?ca5e","webpack:///./src/industrywar/pages/accounts/loginWeibo.vue?8acd","webpack:///./src/industrywar/pages/accounts/loginWeibo.vue"],"names":["webpackJsonp","6","module","exports","methods","toggleSidebar","$","sidebar","7","8","__webpack_require__","__vue_script__","__vue_template__","__esModule","options","template","163","debug","moment","toastr","data","userData","loading","firstAuth","components","navbar","computed","showCard","this","useWeiboInfo","avatar","vm","currentUser","set","name","AV","File","withURL","avatar_large","save","then","_this","avatarObj","result","$router","go","error","filters","fromNow","val","Date","ready","code","$el","querySelector","dimmer","on","$route","query","Cloud","run","success","user_data","becomeUser","token","err","message","error_description","vuex","getters","state","accounts","actions","arg","sessionToken","dispatch","User","become","user","current","get","192","push","id","version","sources","names","mappings","file","sourcesContent","sourceRoot","215","content","locals","255","274"],"mappings":"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","file":"5.c5ffb173f38c614e3cf3.js","sourcesContent":["webpackJsonp([5],{\n\n/***/ 6:\n/***/ function(module, exports) {\n\n\tmodule.exports = {\n\t  methods: {\n\t    toggleSidebar: function() {\n\t      return $('.ui.sidebar').sidebar('toggle');\n\t    }\n\t  }\n\t};\n\n\n/***/ },\n\n/***/ 7:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div v-show=!isSidebarHidden class=\\\"ui top fixed borderless menu\\\"><a @click=toggleSidebar class=\\\"launch icon item\\\"><slot name=toggleButton><i class=\\\"content icon\\\"></i></slot></a><slot></slot></div>\";\n\n/***/ },\n\n/***/ 8:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__vue_script__ = __webpack_require__(6)\n\t__vue_template__ = __webpack_require__(7)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n\n/***/ 163:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar debug, moment, toastr;\n\t\n\tdebug = __webpack_require__(5)('loginWithWeibo');\n\t\n\tmoment = __webpack_require__(1);\n\t\n\ttoastr = __webpack_require__(10);\n\t\n\tmodule.exports = {\n\t  data: function() {\n\t    return {\n\t      userData: null,\n\t      loading: false,\n\t      firstAuth: false\n\t    };\n\t  },\n\t  components: {\n\t    navbar: __webpack_require__(8)\n\t  },\n\t  computed: {\n\t    showCard: function() {\n\t      return (this.userData != null) && !this.loading && this.firstAuth;\n\t    }\n\t  },\n\t  methods: {\n\t    useWeiboInfo: function() {\n\t      var avatar, vm;\n\t      vm = this;\n\t      if (this.currentUser != null) {\n\t        debug(\"使用当前微博提供的用户信息\");\n\t        this.currentUser.set(\"username\", this.userData.name);\n\t        avatar = AV.File.withURL('avatar.jpg', this.userData.avatar_large);\n\t        this.loading = true;\n\t        return avatar.save().then((function(_this) {\n\t          return function(avatarObj) {\n\t            _this.currentUser.set(\"avatar\", avatarObj);\n\t            return _this.currentUser.save().then(function(result) {\n\t              debug(\"保存 用户信息成功！\", result);\n\t              return _this.$router.go({\n\t                name: \"messages\"\n\t              });\n\t            })[\"catch\"](function(error) {\n\t              debug(\"保存用户信息失败！\", error);\n\t              return _this.loading = false;\n\t            });\n\t          };\n\t        })(this))[\"catch\"](function(error) {\n\t          return debug(\"头像上传失败。\", error);\n\t        });\n\t      }\n\t    }\n\t  },\n\t  filters: {\n\t    fromNow: function(val) {\n\t      return moment(new Date(val)).fromNow();\n\t    }\n\t  },\n\t  ready: function() {\n\t    var code;\n\t    $(this.$el.querySelector('.dimmer')).dimmer({\n\t      on: 'hover'\n\t    });\n\t    code = this.$route.query.code;\n\t    if (code != null) {\n\t      return AV.Cloud.run('auth_weibo', {\n\t        code: code\n\t      }, {\n\t        success: (function(_this) {\n\t          return function(data) {\n\t            debug(\"获得了登陆信息：\", data);\n\t            _this.userData = data.user_data;\n\t            return _this.becomeUser(data.token);\n\t          };\n\t        })(this),\n\t        error: (function(_this) {\n\t          return function(err) {\n\t            debug(\"微博登陆失败：\", err);\n\t            toastr.error(err.message.error_description, \"微博登陆失败\");\n\t            _this.$router.go({\n\t              name: 'login'\n\t            });\n\t          };\n\t        })(this)\n\t      });\n\t    }\n\t  },\n\t  vuex: {\n\t    getters: {\n\t      currentUser: function(state) {\n\t        return state.accounts.currentUser;\n\t      }\n\t    },\n\t    actions: {\n\t      becomeUser: function(arg, sessionToken) {\n\t        var dispatch, state;\n\t        dispatch = arg.dispatch, state = arg.state;\n\t        return AV.User.become(sessionToken).then((function(_this) {\n\t          return function(user) {\n\t            debug(user);\n\t            debug(\"登陆成功！当前用户为:\", AV.User.current());\n\t            dispatch('SET_CURRENT_USER', user);\n\t            if (user.get(\"avatar\") != null) {\n\t              toastr.success(\"授权成功！欢迎回来。\");\n\t              _this.$router.go({\n\t                name: \"messages\"\n\t              });\n\t            } else {\n\t              _this.firstAuth = true;\n\t            }\n\t          };\n\t        })(this))[\"catch\"]((function(_this) {\n\t          return function(error) {\n\t            toastr.error(err.message, \"用户登陆失败。\");\n\t            _this.$router.go({\n\t              name: 'login'\n\t            });\n\t          };\n\t        })(this));\n\t      }\n\t    }\n\t  }\n\t};\n\n\n/***/ },\n\n/***/ 192:\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(2)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".ui.card[_v-02ea9f4d]{margin:0 auto}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/accounts/loginWeibo.vue\"],\"names\":[],\"mappings\":\"AAAA,sBACE,aAAe,CAChB\",\"file\":\"loginWeibo.vue\",\"sourcesContent\":[\".ui.card[_v-02ea9f4d] {\\n  margin: 0 auto;\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\t\n\t// exports\n\n\n/***/ },\n\n/***/ 215:\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(192);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(4)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./loginWeibo.vue\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./loginWeibo.vue\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n\n/***/ 255:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"ui container\\\" _v-02ea9f4d=\\\"\\\"><navbar _v-02ea9f4d=\\\"\\\"><div class=item _v-02ea9f4d=\\\"\\\">微博登陆</div></navbar><div class=\\\"ui padded stackable grid\\\" _v-02ea9f4d=\\\"\\\"><div class=row _v-02ea9f4d=\\\"\\\"><div class=column _v-02ea9f4d=\\\"\\\"><div class=\\\"ui breadcrumb\\\" _v-02ea9f4d=\\\"\\\"><a v-link=\\\"{name:'login'}\\\" class=section _v-02ea9f4d=\\\"\\\">登陆</a><div class=divider _v-02ea9f4d=\\\"\\\">/</div><div class=\\\"active section\\\" _v-02ea9f4d=\\\"\\\">微博登陆</div></div><div class=\\\"ui info message\\\" _v-02ea9f4d=\\\"\\\"><i class=\\\"weibo icon\\\" _v-02ea9f4d=\\\"\\\"></i>确认你的微博账号信息</div></div></div><div class=\\\"two column row\\\" _v-02ea9f4d=\\\"\\\"><div v-if=!showCard class=column _v-02ea9f4d=\\\"\\\"><div class=\\\"ui active centered large inline loader\\\" _v-02ea9f4d=\\\"\\\"></div></div><div v-if=showCard class=column _v-02ea9f4d=\\\"\\\"><div class=\\\"ui card\\\" _v-02ea9f4d=\\\"\\\"><div class=\\\"blurring dummable image\\\" _v-02ea9f4d=\\\"\\\"><div class=\\\"ui dimmer\\\" _v-02ea9f4d=\\\"\\\"><div class=content _v-02ea9f4d=\\\"\\\"><div class=center _v-02ea9f4d=\\\"\\\"><div class=\\\"ui inverted button\\\" _v-02ea9f4d=\\\"\\\">替换头像</div></div></div></div><img :src=userData.avatar_large _v-02ea9f4d=\\\"\\\"></div><div class=content _v-02ea9f4d=\\\"\\\"><a class=header _v-02ea9f4d=\\\"\\\">{{ userData.name }}</a><div class=meta _v-02ea9f4d=\\\"\\\"> {{ userData.location }}，创建于 {{ userData.created_at | fromNow }}</div></div><div class=\\\"extra content\\\" _v-02ea9f4d=\\\"\\\"><div class=\\\"right floated\\\" _v-02ea9f4d=\\\"\\\"><div v-show=!loading transition=semantic v-link=\\\"{name:'map'}\\\" class=\\\"ui button transition fade left\\\" _v-02ea9f4d=\\\"\\\">不使用</div><div @click=useWeiboInfo :class={loading:loading} class=\\\"ui primary button\\\" _v-02ea9f4d=\\\"\\\">使用这些信息</div></div></div></div></div><div class=column _v-02ea9f4d=\\\"\\\"></div></div></div></div>\";\n\n/***/ },\n\n/***/ 274:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(215)\n\t__vue_script__ = __webpack_require__(163)\n\t__vue_template__ = __webpack_require__(255)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** 5.c5ffb173f38c614e3cf3.js\n **/","# <template lang=\"jade\">\n# .ui.top.fixed.borderless.menu(v-show=\"!isSidebarHidden\")\n#   a.launch.icon.item(@click=\"toggleSidebar\")\n#     slot(name=\"toggleButton\")\n#       i.content.icon\n#   slot\n# </template>\n#\n# <script lang=\"coffee\">\nmodule.exports=\n  methods:\n    toggleSidebar:->\n      $('.ui.sidebar').sidebar('toggle')\n\n# </script>\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/vue-loader/lib/selector.js?type=script&index=0!./src/industrywar/components/navbar.vue\n **/","module.exports = \"<div v-show=!isSidebarHidden class=\\\"ui top fixed borderless menu\\\"><a @click=toggleSidebar class=\\\"launch icon item\\\"><slot name=toggleButton><i class=\\\"content icon\\\"></i></slot></a><slot></slot></div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-loader.js?raw&engine=jade!./~/vue-loader/lib/selector.js?type=template&index=0!./src/industrywar/components/navbar.vue\n ** module id = 7\n ** module chunks = 2 3 4 5 6\n **/","var __vue_script__, __vue_template__\n__vue_script__ = require(\"!!coffee!./../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./navbar.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../../node_modules/vue-loader/lib/template-loader.js?raw&engine=jade!./../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./navbar.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/industrywar/components/navbar.vue\n ** module id = 8\n ** module chunks = 2 3 4 5 6\n **/","# <template lang=\"jade\">\n# .ui.container\n#   navbar\n#     .item 微博登陆\n#   .ui.padded.stackable.grid\n#     .row\n#       .column\n#         .ui.breadcrumb\n#           a.section(v-link=\"{name:'login'}\") 登陆\n#           .divider /\n#           .active.section 微博登陆\n#         .ui.info.message\n#           i.weibo.icon\n#           | 确认你的微博账号信息\n#     .two.column.row\n#       .column(v-if=\"!showCard\")\n#         .ui.active.centered.large.inline.loader\n#       .column(v-if=\"showCard\")\n#         .ui.card\n#           .blurring.dummable.image\n#             .ui.dimmer\n#               .content\n#                 .center\n#                   .ui.inverted.button 替换头像\n#             img(:src=\"userData.avatar_large\")\n#           .content\n#             a.header {{ userData.name }}\n#             .meta\n#               |  {{ userData.location }}，创建于 {{ userData.created_at | fromNow }}\n#           .extra.content\n#             .right.floated\n#               .ui.button.transition.fade.left(v-show=\"!loading\",transition=\"semantic\",v-link=\"{name:'map'}\") 不使用\n#               .ui.primary.button(@click=\"useWeiboInfo\",:class=\"{loading:loading}\") 使用这些信息\n#       .column\n#         //- p {{ userData | json }}\n# </template>\n#\n# <style lang=\"stylus\" scoped>\n#   .ui.card\n#     margin 0 auto\n# </style>\n#\n# <script lang=\"coffee\">\ndebug = require('debug')('loginWithWeibo')\nmoment = require(\"moment\")\ntoastr = require(\"toastr\")\nmodule.exports=\n  data:->\n    # userData:{\"id\":1679788655,\"idstr\":\"1679788655\",\"class\":1,\"screen_name\":\"码日光\",\"name\":\"码日光\",\"province\":\"44\",\"city\":\"18\",\"location\":\"广东 清远\",\"description\":\"马日光\",\"url\":\"\",\"profile_image_url\":\"http://tva1.sinaimg.cn/crop.0.0.480.480.50/641f8a6fjw8eamnuv46arj20dc0dcwf2.jpg\",\"cover_image_phone\":\"http://ww1.sinaimg.cn/crop.0.0.640.640.640/549d0121tw1egm1kjly3jj20hs0hsq4f.jpg\",\"profile_url\":\"u/1679788655\",\"domain\":\"\",\"weihao\":\"\",\"gender\":\"m\",\"followers_count\":68,\"friends_count\":122,\"pagefriends_count\":0,\"statuses_count\":35,\"favourites_count\":10,\"created_at\":\"Sat Jan 09 16:56:30 +0800 2010\",\"following\":false,\"allow_all_act_msg\":false,\"geo_enabled\":false,\"verified\":false,\"verified_type\":-1,\"remark\":\"\",\"status\":{\"created_at\":\"Wed Feb 03 21:41:39 +0800 2016\",\"id\":3938549755771174,\"mid\":\"3938549755771174\",\"idstr\":\"3938549755771174\",\"text\":\"转发微博\",\"source_allowclick\":0,\"source_type\":1,\"source\":\"<a href=\\\"http://app.weibo.com/t/feed/qsbvs\\\" rel=\\\"nofollow\\\">手机微博触屏版</a>\",\"favorited\":false,\"truncated\":false,\"in_reply_to_status_id\":\"\",\"in_reply_to_user_id\":\"\",\"in_reply_to_screen_name\":\"\",\"pic_urls\":[],\"geo\":null,\"annotations\":[{\"mapi_request\":true}],\"reposts_count\":0,\"comments_count\":0,\"attitudes_count\":0,\"isLongText\":false,\"mlevel\":0,\"visible\":{\"type\":0,\"list_id\":0},\"biz_feature\":0,\"darwin_tags\":[],\"hot_weibo_tags\":[],\"text_tag_tips\":[],\"userType\":0},\"ptype\":0,\"allow_all_comment\":true,\"avatar_large\":\"http://tva1.sinaimg.cn/crop.0.0.480.480.180/641f8a6fjw8eamnuv46arj20dc0dcwf2.jpg\",\"avatar_hd\":\"http://tva1.sinaimg.cn/crop.0.0.480.480.1024/641f8a6fjw8eamnuv46arj20dc0dcwf2.jpg\",\"verified_reason\":\"\",\"verified_trade\":\"\",\"verified_reason_url\":\"\",\"verified_source\":\"\",\"verified_source_url\":\"\",\"follow_me\":false,\"online_status\":0,\"bi_followers_count\":42,\"lang\":\"zh-cn\",\"star\":0,\"mbtype\":0,\"mbrank\":0,\"block_word\":0,\"block_app\":0,\"credit_score\":80,\"user_ability\":0,\"urank\":15}\n    userData:null\n    loading:false\n    firstAuth:false\n  components:\n    navbar:require \"../../components/navbar.vue\"\n  computed:\n    showCard:->\n      @userData? and not @loading and @firstAuth\n  methods:\n    useWeiboInfo:->\n      #使用微博的用户信息\n      vm = @\n      if @currentUser?\n        debug(\"使用当前微博提供的用户信息\")\n        @currentUser.set(\"username\",@userData.name)\n        avatar = AV.File.withURL('avatar.jpg',@userData.avatar_large)\n        @loading = true\n        avatar.save().then((avatarObj)=>\n          @currentUser.set(\"avatar\",avatarObj)\n          @currentUser.save().then((result)=>\n            debug(\"保存 用户信息成功！\",result)\n            @$router.go({name:\"messages\"})\n          ).catch((error)=>\n            debug(\"保存用户信息失败！\",error)\n            @loading=false\n          )\n        ).catch((error)->\n          debug(\"头像上传失败。\",error)\n        )\n\n  filters:\n    fromNow:(val)->\n      moment(new Date(val)).fromNow()\n  ready:->\n    $(@$el.querySelector('.dimmer')).dimmer({\n      on: 'hover'\n    })\n    code = @$route.query.code\n    if code?\n      AV.Cloud.run 'auth_weibo', {code},\n        success: (data)=>\n          # 调用成功，得到成功的应答 data\n          debug(\"获得了登陆信息：\",data)\n          @userData = data.user_data\n          @becomeUser(data.token)\n        error: (err) =>\n          # 处理调用失败\n          debug(\"微博登陆失败：\",err)\n          toastr.error(err.message.error_description,\"微博登陆失败\")\n          @$router.go({name:'login'})\n          return\n  vuex:\n    getters:\n      currentUser:(state)->\n        state.accounts.currentUser\n    actions:\n      becomeUser:({dispatch,state},sessionToken)->\n        AV.User.become(sessionToken).then((user)=> #直接使用token来进行登陆\n          # The current user is changed.\n          debug(user)\n          debug(\"登陆成功！当前用户为:\",AV.User.current())\n          dispatch('SET_CURRENT_USER',user)\n          if user.get(\"avatar\")? #用户已经有头像了\n            toastr.success(\"授权成功！欢迎回来。\")\n            @$router.go({name:\"messages\"}) #直接跳过这个步骤。\n          else\n            @firstAuth = true\n          return\n        ).catch((error) =>\n          toastr.error(err.message,\"用户登陆失败。\")\n          @$router.go({name:'login'})\n          # Login failed.\n          return\n        )\n\n    # \"?grant_type=authorization_code&redirect_uri=YOUR_REGISTERED_REDIRECT_URI&code=CODE\"\n    # @$http.get \"https://api.weibo.com/oauth2/access_token\",\n    #   client_id:\"1994164454\"\n    #   client_secret:\"42fb5a4d861e9be5abc1b4d13843a686\"\n# </script>\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/vue-loader/lib/selector.js?type=script&index=0!./src/industrywar/pages/accounts/loginWeibo.vue\n **/","exports = module.exports = require(\"./../../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".ui.card[_v-02ea9f4d]{margin:0 auto}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/accounts/loginWeibo.vue\"],\"names\":[],\"mappings\":\"AAAA,sBACE,aAAe,CAChB\",\"file\":\"loginWeibo.vue\",\"sourcesContent\":[\".ui.card[_v-02ea9f4d] {\\n  margin: 0 auto;\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=0!./src/industrywar/pages/accounts/loginWeibo.vue\n ** module id = 192\n ** module chunks = 5\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./loginWeibo.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./loginWeibo.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./loginWeibo.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"extract\":true,\"remove\":true}!./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=0!./src/industrywar/pages/accounts/loginWeibo.vue\n ** module id = 215\n ** module chunks = 5\n **/","module.exports = \"<div class=\\\"ui container\\\" _v-02ea9f4d=\\\"\\\"><navbar _v-02ea9f4d=\\\"\\\"><div class=item _v-02ea9f4d=\\\"\\\">微博登陆</div></navbar><div class=\\\"ui padded stackable grid\\\" _v-02ea9f4d=\\\"\\\"><div class=row _v-02ea9f4d=\\\"\\\"><div class=column _v-02ea9f4d=\\\"\\\"><div class=\\\"ui breadcrumb\\\" _v-02ea9f4d=\\\"\\\"><a v-link=\\\"{name:'login'}\\\" class=section _v-02ea9f4d=\\\"\\\">登陆</a><div class=divider _v-02ea9f4d=\\\"\\\">/</div><div class=\\\"active section\\\" _v-02ea9f4d=\\\"\\\">微博登陆</div></div><div class=\\\"ui info message\\\" _v-02ea9f4d=\\\"\\\"><i class=\\\"weibo icon\\\" _v-02ea9f4d=\\\"\\\"></i>确认你的微博账号信息</div></div></div><div class=\\\"two column row\\\" _v-02ea9f4d=\\\"\\\"><div v-if=!showCard class=column _v-02ea9f4d=\\\"\\\"><div class=\\\"ui active centered large inline loader\\\" _v-02ea9f4d=\\\"\\\"></div></div><div v-if=showCard class=column _v-02ea9f4d=\\\"\\\"><div class=\\\"ui card\\\" _v-02ea9f4d=\\\"\\\"><div class=\\\"blurring dummable image\\\" _v-02ea9f4d=\\\"\\\"><div class=\\\"ui dimmer\\\" _v-02ea9f4d=\\\"\\\"><div class=content _v-02ea9f4d=\\\"\\\"><div class=center _v-02ea9f4d=\\\"\\\"><div class=\\\"ui inverted button\\\" _v-02ea9f4d=\\\"\\\">替换头像</div></div></div></div><img :src=userData.avatar_large _v-02ea9f4d=\\\"\\\"></div><div class=content _v-02ea9f4d=\\\"\\\"><a class=header _v-02ea9f4d=\\\"\\\">{{ userData.name }}</a><div class=meta _v-02ea9f4d=\\\"\\\"> {{ userData.location }}，创建于 {{ userData.created_at | fromNow }}</div></div><div class=\\\"extra content\\\" _v-02ea9f4d=\\\"\\\"><div class=\\\"right floated\\\" _v-02ea9f4d=\\\"\\\"><div v-show=!loading transition=semantic v-link=\\\"{name:'map'}\\\" class=\\\"ui button transition fade left\\\" _v-02ea9f4d=\\\"\\\">不使用</div><div @click=useWeiboInfo :class={loading:loading} class=\\\"ui primary button\\\" _v-02ea9f4d=\\\"\\\">使用这些信息</div></div></div></div></div><div class=column _v-02ea9f4d=\\\"\\\"></div></div></div></div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-rewriter.js?id=_v-02ea9f4d!./~/vue-loader/lib/template-loader.js?raw&engine=jade!./~/vue-loader/lib/selector.js?type=template&index=0!./src/industrywar/pages/accounts/loginWeibo.vue\n ** module id = 255\n ** module chunks = 5\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-02ea9f4d&scoped=true!stylus-loader?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./loginWeibo.vue\")\n__vue_script__ = require(\"!!coffee!./../../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./loginWeibo.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../../../node_modules/vue-loader/lib/template-rewriter.js?id=_v-02ea9f4d!./../../../../node_modules/vue-loader/lib/template-loader.js?raw&engine=jade!./../../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./loginWeibo.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/industrywar/pages/accounts/loginWeibo.vue\n ** module id = 274\n ** module chunks = 5\n **/"],"sourceRoot":""}