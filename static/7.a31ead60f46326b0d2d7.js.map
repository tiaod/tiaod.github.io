{"version":3,"sources":["webpack:///7.a31ead60f46326b0d2d7.js","webpack:///./src/industrywar/components/classes/Scene.coffee","webpack:///./src/industrywar/pages/scene/scene.vue?08a5","webpack:///./src/industrywar/pages/scene/scene.vue?b99f","webpack:///./src/industrywar/pages/scene/scene.vue?a1ba","webpack:///./src/industrywar/pages/scene/scene.vue?a673","webpack:///./src/industrywar/pages/scene/scene.vue"],"names":["webpackJsonp","14","module","exports","__webpack_require__","AV","Object","extend","170","Scene","debug","data","current","state","step","isChoosing","choices","typing","string","bgImage","scene","sceneData","attached","this","reset","computed","currentState","nextString","ref","ref1","strings","methods","typed","text","sendSceneMessage","$","callback","_this","dialogClicked","next","apply","doAction","action","goto","name","createState","exit","history","go","route","transition","query","sceneId","to","params","id","Query","get","then","result","Function","error","console","vuex","actions","addSceneToMessagesList","arg","dispatch","message","205","push","version","sources","names","mappings","file","sourcesContent","sourceRoot","228","content","locals","268","281","__vue_script__","__vue_template__","__esModule","options","template"],"mappings":"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","file":"7.a31ead60f46326b0d2d7.js","sourcesContent":["webpackJsonp([7],{\n\n/***/ 14:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar AV;\n\t\n\tAV = __webpack_require__(11);\n\t\n\tmodule.exports = AV.Object.extend('Scene');\n\n\n/***/ },\n\n/***/ 170:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar Scene, debug;\n\t\n\tScene = __webpack_require__(14);\n\t\n\tdebug = __webpack_require__(5)(\"scene\");\n\t\n\tmodule.exports = {\n\t  data: function() {\n\t    return {\n\t      current: {\n\t        state: \"default\",\n\t        step: 0,\n\t        isChoosing: false,\n\t        choices: [],\n\t        typing: true,\n\t        string: \"\"\n\t      },\n\t      bgImage: \"/static/bg3.jpg\",\n\t      scene: null,\n\t      sceneData: {}\n\t    };\n\t  },\n\t  attached: function() {\n\t    return this.reset();\n\t  },\n\t  computed: {\n\t    currentState: function() {\n\t      return this.sceneData[this.current.state];\n\t    },\n\t    nextString: function() {\n\t      var ref, ref1;\n\t      return (ref = this.currentState) != null ? (ref1 = ref.strings) != null ? ref1[this.current.step] : void 0 : void 0;\n\t    }\n\t  },\n\t  methods: {\n\t    typed: function(text) {\n\t      this.sendSceneMessage(text);\n\t      this.current.string = text;\n\t      $(\".scene.string > span\").typed('reset');\n\t      this.current.typing = true;\n\t      return $(\".scene.string > span\").typed({\n\t        strings: [text],\n\t        callback: (function(_this) {\n\t          return function() {\n\t            return _this.current.typing = false;\n\t          };\n\t        })(this)\n\t      });\n\t    },\n\t    reset: function() {\n\t      return this.current = {\n\t        state: \"default\",\n\t        step: 0,\n\t        isChoosing: false,\n\t        choices: [],\n\t        typing: true,\n\t        string: \"\"\n\t      };\n\t    },\n\t    dialogClicked: function() {\n\t      if (this.current.typing) {\n\t        return this.current.typing = false;\n\t      } else {\n\t        return this.next();\n\t      }\n\t    },\n\t    next: function() {\n\t      debug(\"下一步\");\n\t      if (this.nextString != null) {\n\t        debug(\"显示下一句话\");\n\t        this.typed(this.nextString);\n\t        return this.current.step++;\n\t      } else if (this.currentState.choices != null) {\n\t        debug(\"显示选项\");\n\t        this.current.isChoosing = true;\n\t        return this.current.choices = this.currentState.choices;\n\t      } else if (this.currentState.next != null) {\n\t        if (typeof this.currentState.next === \"string\") {\n\t          debug(\"跳转到下一步\");\n\t          this.current.step = 0;\n\t          this.current.state = this.currentState.next;\n\t          return this.next();\n\t        } else if (typeof this.currentState.next === \"function\") {\n\t          return this.currentState.next.apply(this);\n\t        }\n\t      } else {\n\t        return debug(\"这是最后一句了\");\n\t      }\n\t    },\n\t    doAction: function(action) {\n\t      this.current.isChoosing = false;\n\t      action.apply(this);\n\t      this.next();\n\t    },\n\t    goto: function(name) {\n\t      this.current.state = name;\n\t      return this.current.step = 0;\n\t    },\n\t    createState: function(name, state) {\n\t      return this.sceneData[name] = state;\n\t    },\n\t    exit: function() {\n\t      return history.go(-1);\n\t    }\n\t  },\n\t  route: {\n\t    data: function(transition) {\n\t      var query, sceneId;\n\t      sceneId = transition.to.params.id;\n\t      query = new AV.Query(Scene);\n\t      query.get(sceneId).then((function(_this) {\n\t        return function(result) {\n\t          var sceneData;\n\t          debug(result);\n\t          sceneData = (new Function(result.get(\"functionBody\")))();\n\t          debug(sceneData);\n\t          transition.next({\n\t            sceneData: sceneData,\n\t            scene: result\n\t          });\n\t          return _this.next();\n\t        };\n\t      })(this))[\"catch\"](function(error) {\n\t        return console.error(error);\n\t      });\n\t    }\n\t  },\n\t  vuex: {\n\t    actions: {\n\t      addSceneToMessagesList: function(arg, scene) {\n\t        var dispatch;\n\t        dispatch = arg.dispatch;\n\t        return dispatch(\"ADD_SCENE_TO_MESSAGES_LIST\", scene);\n\t      },\n\t      sendSceneMessage: function(arg, message) {\n\t        var dispatch;\n\t        dispatch = arg.dispatch;\n\t        return dispatch(\"SEND_SCENE_MESSAGE\", this.scene.id, message);\n\t      }\n\t    }\n\t  }\n\t};\n\n\n/***/ },\n\n/***/ 205:\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(2)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".typed-cursor[_v-e768ff64]{opacity:1;-webkit-animation:blink .7s infinite;animation:blink .7s infinite}.ui.top.fixed.transparent.menu[_v-e768ff64]{background-color:hsla(0,0%,100%,.75)}.typed[_v-e768ff64]{white-space:pre}.ui.dialog.segment[_v-e768ff64]{width:100%;position:fixed;min-height:15em;bottom:0;background-color:rgba(0,0,0,.8);color:#fff;margin-bottom:0;border-radius:0}.main.background[_v-e768ff64]{top:0;background-position:50% 50%;background-attachment:fixed;background-size:cover;height:100%;width:100%;position:fixed}.main.foreground[_v-e768ff64]{margin-top:10%;background-position:50% 100%;background-size:contain;background-repeat:no-repeat}.choices[_v-e768ff64],.main.foreground[_v-e768ff64]{position:fixed;height:100%;width:100%}.choices .grid[_v-e768ff64]{height:100%}.choices .grid .column[_v-e768ff64]{max-width:992px}.choices .grid .ui.segment[_v-e768ff64]{background-color:hsla(0,0%,100%,.2)}.choices .grid .ui.segment button[_v-e768ff64]{margin-bottom:.75em;opacity:.9}.choices .grid .ui.segment button[_v-e768ff64]:last-child{margin-bottom:0}@-webkit-keyframes blink{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes blink{0%{opacity:1}50%{opacity:0}to{opacity:1}}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/scene/scene.vue\"],\"names\":[],\"mappings\":\"AAAA,2BACE,UAAW,AACX,qCAAuC,AAC/B,4BAA+B,CACxC,AACD,4CACE,oCAAyC,CAC1C,AACD,oBACE,eAAiB,CAClB,AACD,gCACE,WAAY,AACZ,eAAgB,AAChB,gBAAiB,AACjB,SAAU,AACV,gCAAkC,AAClC,WAAY,AACZ,gBAAiB,AACjB,eAAiB,CAClB,AACD,8BACE,MAAO,AACP,4BAA6B,AAC7B,4BAA6B,AAC7B,sBAAuB,AACvB,YAAa,AACb,WAAY,AACZ,cAAgB,CACjB,AACD,8BACE,eAAgB,AAEhB,6BAA8B,AAC9B,wBAAyB,AACzB,2BAA6B,CAG9B,AACD,oDAPE,eAAgB,AAIhB,YAAa,AACb,UAAY,CAMb,AACD,4BACE,WAAa,CAEd,AACD,oCACE,eAAiB,CAClB,AACD,wCACE,mCAAwC,CACzC,AACD,+CACE,oBAAsB,AACtB,UAAa,CACd,AACD,0DACE,eAAiB,CAClB,AACD,yBACE,GACE,SAAW,CACZ,AACD,IACE,SAAW,CACZ,AACD,GACE,SAAW,CACZ,CACF,AACD,iBACE,GACE,SAAW,CACZ,AACD,IACE,SAAW,CACZ,AACD,GACE,SAAW,CACZ,CACF\",\"file\":\"scene.vue\",\"sourcesContent\":[\".typed-cursor[_v-e768ff64] {\\n  opacity: 1;\\n  -webkit-animation: blink 0.7s infinite;\\n          animation: blink 0.7s infinite;\\n}\\n.ui.top.fixed.transparent.menu[_v-e768ff64] {\\n  background-color: rgba(255,255,255,0.75);\\n}\\n.typed[_v-e768ff64] {\\n  white-space: pre;\\n}\\n.ui.dialog.segment[_v-e768ff64] {\\n  width: 100%;\\n  position: fixed;\\n  min-height: 15em;\\n  bottom: 0;\\n  background-color: rgba(0,0,0,0.8);\\n  color: #fff;\\n  margin-bottom: 0;\\n  border-radius: 0;\\n}\\n.main.background[_v-e768ff64] {\\n  top: 0;\\n  background-position: 50% 50%;\\n  background-attachment: fixed;\\n  background-size: cover;\\n  height: 100%;\\n  width: 100%;\\n  position: fixed;\\n}\\n.main.foreground[_v-e768ff64] {\\n  margin-top: 10%;\\n  position: fixed;\\n  background-position: 50% 100%;\\n  background-size: contain;\\n  background-repeat: no-repeat;\\n  height: 100%;\\n  width: 100%;\\n}\\n.choices[_v-e768ff64] {\\n  height: 100%;\\n  width: 100%;\\n  position: fixed;\\n}\\n.choices .grid[_v-e768ff64] {\\n  height: 100%;\\n/*position relative*/\\n}\\n.choices .grid .column[_v-e768ff64] {\\n  max-width: 992px;\\n}\\n.choices .grid .ui.segment[_v-e768ff64] {\\n  background-color: rgba(255,255,255,0.2);\\n}\\n.choices .grid .ui.segment button[_v-e768ff64] {\\n  margin-bottom: 0.75em;\\n  opacity: 0.9;\\n}\\n.choices .grid .ui.segment button[_v-e768ff64]:last-child {\\n  margin-bottom: 0;\\n}\\n@-webkit-keyframes blink {\\n  0% {\\n    opacity: 1;\\n  }\\n  50% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\\n@keyframes blink {\\n  0% {\\n    opacity: 1;\\n  }\\n  50% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\t\n\t// exports\n\n\n/***/ },\n\n/***/ 228:\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(205);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(4)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./scene.vue\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./scene.vue\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n\n/***/ 268:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div _v-e768ff64=\\\"\\\"><div :style=\\\"{backgroundImage:'url('+bgImage+')'}\\\" class=\\\"main background\\\" _v-e768ff64=\\\"\\\"></div><div :style=\\\"{backgroundImage:'url(/static/npc.png)'}\\\" class=\\\"main foreground\\\" _v-e768ff64=\\\"\\\"></div><div class=\\\"ui top fixed transparent icon menu\\\" _v-e768ff64=\\\"\\\"><a @click=exit class=item _v-e768ff64=\\\"\\\"><i class=\\\"ui chevron left icon\\\" _v-e768ff64=\\\"\\\"></i></a><div class=\\\"right menu\\\" _v-e768ff64=\\\"\\\"><div class=item _v-e768ff64=\\\"\\\"><i class=\\\"info icon\\\" _v-e768ff64=\\\"\\\"></i></div></div></div><div @click=dialogClicked class=\\\"ui dialog segment\\\" _v-e768ff64=\\\"\\\"><div class=\\\"ui container\\\" _v-e768ff64=\\\"\\\"><h1 _v-e768ff64=\\\"\\\">新手向导</h1><p v-show=current.typing class=\\\"scene string\\\" _v-e768ff64=\\\"\\\"><span class=typing _v-e768ff64=\\\"\\\"></span></p><p v-show=!current.typing class=\\\"finished string\\\" _v-e768ff64=\\\"\\\"><span _v-e768ff64=\\\"\\\">{{ current.string }}</span></p></div></div><div transition=semantic v-show=current.isChoosing class=\\\"ui choices scale transition\\\" _v-e768ff64=\\\"\\\"><div class=\\\"ui middle aligned center aligned padded grid\\\" _v-e768ff64=\\\"\\\"><div class=column _v-e768ff64=\\\"\\\"><div class=\\\"ui segment\\\" _v-e768ff64=\\\"\\\"><button v-for=\\\"choice in current.choices\\\" @click=doAction(choice.action) class=\\\"big ui fluid button\\\" _v-e768ff64=\\\"\\\">{{ choice.title }}</button></div></div></div></div></div>\";\n\n/***/ },\n\n/***/ 281:\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(228)\n\t__vue_script__ = __webpack_require__(170)\n\t__vue_template__ = __webpack_require__(268)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** 7.a31ead60f46326b0d2d7.js\n **/","AV = require \"avoscloud-sdk\"\nmodule.exports= AV.Object.extend('Scene')\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/industrywar/components/classes/Scene.coffee\n **/","#\n# <template lang=\"jade\">\n# div\n#\n#   .main.background(:style=\"{backgroundImage:'url('+bgImage+')'}\")\n#   .main.foreground(:style=\"{backgroundImage:'url(/static/npc.png)'}\")\n#   .ui.top.fixed.transparent.icon.menu\n#     a.item(@click=\"exit\")\n#       i.ui.chevron.left.icon\n#     .right.menu\n#       .item\n#         i.info.icon\n#   .ui.dialog.segment(@click=\"dialogClicked\")\n#     .ui.container\n#       h1 新手向导\n#       //- p {{ nextString | json}}\n#       //- p {{ current | json }}\n#       p.scene.string(v-show=\"current.typing\")\n#         span.typing\n#       p.finished.string(v-show=\"!current.typing\")\n#         span {{ current.string }}\n#   .ui.choices.scale.transition(transition=\"semantic\",v-show = \"current.isChoosing\")\n#     .ui.middle.aligned.center.aligned.padded.grid\n#       .column\n#         .ui.segment\n#           button.big.ui.fluid.button(v-for=\"choice in current.choices\",\n#                                          @click=\"doAction(choice.action)\") {{ choice.title }}\n# </template>\n#\n# <script lang=\"coffee\">\r\nScene = require \"../../components/classes/Scene.coffee\"\r\ndebug=require(\"debug\")(\"scene\")\r\nmodule.exports=\r\n  data:->\r\n    current:#可以理解为当前状态的指针\r\n      state:\"default\" #当前状态的名字\r\n      step:0 #状态内部的计数器\r\n      isChoosing:false #是否正在选择\r\n      choices:[] #当前可用选择。数据结构包括title和action\r\n      typing:true #是否正在输入.\r\n      string:\"\" #当前scene所说的话\r\n    bgImage:\"/static/bg3.jpg\" #背景图\r\n    scene:null\r\n    sceneData:{}\r\n  attached:->\r\n    @reset()\r\n  computed:\r\n    currentState:->\r\n      @sceneData[@current.state]\r\n    nextString:->\r\n      @currentState?.strings?[@current.step]\r\n  methods:\r\n    typed:(text)->\r\n      @sendSceneMessage(text)\r\n      @current.string = text\r\n      $(\".scene.string > span\").typed('reset')\r\n      @current.typing=true\r\n      $(\".scene.string > span\").typed\r\n        strings: [text]\r\n        callback:=>\r\n          @current.typing = false #typing结束，设置状态为false\r\n    reset:->\r\n      @current = #直接重置指针\r\n        state:\"default\" #当前状态的名字\r\n        step:0 #状态内部的计数器\r\n        isChoosing:false #是否正在选择\r\n        choices:[] #当前可用选择。数据结构包括title和action\r\n        typing:true #是否正在输入.\r\n        string:\"\" #当前scene所说的话\r\n    dialogClicked:->\r\n      if @current.typing\r\n        @current.typing = false\r\n      else\r\n        @next()\r\n    next:->\r\n      debug(\"下一步\")\r\n      # 优先级:nextString > choices > next\r\n      if @nextString? #如果还有下一句话\r\n        debug(\"显示下一句话\")\r\n        @typed(@nextString)\r\n        @current.step++\r\n      else if @currentState.choices? #没有下一句话了,但是有选项？\r\n        debug(\"显示选项\")\r\n        @current.isChoosing = true #显示选项框\r\n        @current.choices = @currentState.choices\r\n      else if @currentState.next? #有下一步?\r\n        if typeof @currentState.next == \"string\"\r\n          debug(\"跳转到下一步\")\r\n          @current.step = 0 #重置计数器\r\n          @current.state=@currentState.next #跳转下一步\r\n          @next()\r\n        else if typeof @currentState.next == \"function\"\r\n          @currentState.next.apply(@)\r\n      else\r\n        debug \"这是最后一句了\"\r\n    doAction:(action)->\r\n      @current.isChoosing = false\r\n      action.apply(@) #执行对应的动作(将当前上下文传入)\r\n      @next() #执行完毕跳转下一步\r\n      return\r\n    goto:(name)-> #仅用于切换状态。可以在动作内部调用.\r\n      @current.state=name\r\n      @current.step = 0\r\n    createState:(name,state)->\r\n      #用于动态新建state\r\n      @sceneData[name]=state\r\n    exit:()-> #退出当前页面\r\n      history.go(-1)\r\n  route:\r\n    data:(transition)->\r\n      sceneId = transition.to.params.id\r\n      query = new AV.Query(Scene)\r\n      query\r\n        .get(sceneId)\r\n        .then((result)=>\r\n          debug result\r\n          # @addSceneToMessagesList(result)\r\n          sceneData = (new Function(result.get(\"functionBody\")))() #对函数解释执行.\r\n          debug(sceneData)\r\n          transition.next({sceneData,scene:result})\r\n          @next()) #在获得scene之后就马上开始解析执行，显示第一句话。。\r\n        .catch((error)->console.error(error))\r\n      return\r\n  vuex:\r\n    actions:\r\n      addSceneToMessagesList:({dispatch},scene)-> #将当前场景添加到对话列表\r\n        dispatch(\"ADD_SCENE_TO_MESSAGES_LIST\",scene)\r\n      sendSceneMessage:({dispatch},message)->\r\n        dispatch(\"SEND_SCENE_MESSAGE\",@scene.id,message)\r\n# </script>\n#\n#\n#\n# <style lang=\"stylus\" scoped>\n# .typed-cursor\n#   opacity 1\n#   animation blink 0.7s infinite\n# .ui.top.fixed.transparent.menu\n#   background-color rgba(255,255,255,0.75)\n# @keyframes blink\n#   0% { opacity:1; }\n#   50% { opacity:0; }\n#   100% { opacity:1; }\n# .typed\n#   white-space:pre\n# .ui.dialog.segment\n#   width 100%\n#   position fixed\n#   min-height 15em\n#   bottom 0\n#   background-color rgba(0,0,0,0.8)\n#   color white\n#   margin-bottom 0\n#   border-radius 0\n# .main.background\n#   top 0\n#   background-position 50% 50%\n#   background-attachment fixed\n#   background-size cover\n#   height 100%\n#   width 100%\n#   position fixed\n# .main.foreground\n#   margin-top 10%\n#   position fixed\n#   background-position 50% 100%\n#   background-size contain\n#   background-repeat no-repeat\n#   height 100%\n#   width 100%\n# .choices\n#   height 100%\n#   width 100%\n#   position fixed\n#   .grid\n#     height 100%\n#     .column\n#       max-width 992px\n#     .ui.segment\n#       background-color:rgba(255,255,255,0.2)\n#       button\n#         margin-bottom 0.75em\n#         opacity:0.9\n#         &:last-child\n#           margin-bottom 0\n#     /*position relative*/\n# </style>\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/vue-loader/lib/selector.js?type=script&index=0!./src/industrywar/pages/scene/scene.vue\n **/","exports = module.exports = require(\"./../../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".typed-cursor[_v-e768ff64]{opacity:1;-webkit-animation:blink .7s infinite;animation:blink .7s infinite}.ui.top.fixed.transparent.menu[_v-e768ff64]{background-color:hsla(0,0%,100%,.75)}.typed[_v-e768ff64]{white-space:pre}.ui.dialog.segment[_v-e768ff64]{width:100%;position:fixed;min-height:15em;bottom:0;background-color:rgba(0,0,0,.8);color:#fff;margin-bottom:0;border-radius:0}.main.background[_v-e768ff64]{top:0;background-position:50% 50%;background-attachment:fixed;background-size:cover;height:100%;width:100%;position:fixed}.main.foreground[_v-e768ff64]{margin-top:10%;background-position:50% 100%;background-size:contain;background-repeat:no-repeat}.choices[_v-e768ff64],.main.foreground[_v-e768ff64]{position:fixed;height:100%;width:100%}.choices .grid[_v-e768ff64]{height:100%}.choices .grid .column[_v-e768ff64]{max-width:992px}.choices .grid .ui.segment[_v-e768ff64]{background-color:hsla(0,0%,100%,.2)}.choices .grid .ui.segment button[_v-e768ff64]{margin-bottom:.75em;opacity:.9}.choices .grid .ui.segment button[_v-e768ff64]:last-child{margin-bottom:0}@-webkit-keyframes blink{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes blink{0%{opacity:1}50%{opacity:0}to{opacity:1}}\", \"\", {\"version\":3,\"sources\":[\"/./src/industrywar/pages/scene/scene.vue\"],\"names\":[],\"mappings\":\"AAAA,2BACE,UAAW,AACX,qCAAuC,AAC/B,4BAA+B,CACxC,AACD,4CACE,oCAAyC,CAC1C,AACD,oBACE,eAAiB,CAClB,AACD,gCACE,WAAY,AACZ,eAAgB,AAChB,gBAAiB,AACjB,SAAU,AACV,gCAAkC,AAClC,WAAY,AACZ,gBAAiB,AACjB,eAAiB,CAClB,AACD,8BACE,MAAO,AACP,4BAA6B,AAC7B,4BAA6B,AAC7B,sBAAuB,AACvB,YAAa,AACb,WAAY,AACZ,cAAgB,CACjB,AACD,8BACE,eAAgB,AAEhB,6BAA8B,AAC9B,wBAAyB,AACzB,2BAA6B,CAG9B,AACD,oDAPE,eAAgB,AAIhB,YAAa,AACb,UAAY,CAMb,AACD,4BACE,WAAa,CAEd,AACD,oCACE,eAAiB,CAClB,AACD,wCACE,mCAAwC,CACzC,AACD,+CACE,oBAAsB,AACtB,UAAa,CACd,AACD,0DACE,eAAiB,CAClB,AACD,yBACE,GACE,SAAW,CACZ,AACD,IACE,SAAW,CACZ,AACD,GACE,SAAW,CACZ,CACF,AACD,iBACE,GACE,SAAW,CACZ,AACD,IACE,SAAW,CACZ,AACD,GACE,SAAW,CACZ,CACF\",\"file\":\"scene.vue\",\"sourcesContent\":[\".typed-cursor[_v-e768ff64] {\\n  opacity: 1;\\n  -webkit-animation: blink 0.7s infinite;\\n          animation: blink 0.7s infinite;\\n}\\n.ui.top.fixed.transparent.menu[_v-e768ff64] {\\n  background-color: rgba(255,255,255,0.75);\\n}\\n.typed[_v-e768ff64] {\\n  white-space: pre;\\n}\\n.ui.dialog.segment[_v-e768ff64] {\\n  width: 100%;\\n  position: fixed;\\n  min-height: 15em;\\n  bottom: 0;\\n  background-color: rgba(0,0,0,0.8);\\n  color: #fff;\\n  margin-bottom: 0;\\n  border-radius: 0;\\n}\\n.main.background[_v-e768ff64] {\\n  top: 0;\\n  background-position: 50% 50%;\\n  background-attachment: fixed;\\n  background-size: cover;\\n  height: 100%;\\n  width: 100%;\\n  position: fixed;\\n}\\n.main.foreground[_v-e768ff64] {\\n  margin-top: 10%;\\n  position: fixed;\\n  background-position: 50% 100%;\\n  background-size: contain;\\n  background-repeat: no-repeat;\\n  height: 100%;\\n  width: 100%;\\n}\\n.choices[_v-e768ff64] {\\n  height: 100%;\\n  width: 100%;\\n  position: fixed;\\n}\\n.choices .grid[_v-e768ff64] {\\n  height: 100%;\\n/*position relative*/\\n}\\n.choices .grid .column[_v-e768ff64] {\\n  max-width: 992px;\\n}\\n.choices .grid .ui.segment[_v-e768ff64] {\\n  background-color: rgba(255,255,255,0.2);\\n}\\n.choices .grid .ui.segment button[_v-e768ff64] {\\n  margin-bottom: 0.75em;\\n  opacity: 0.9;\\n}\\n.choices .grid .ui.segment button[_v-e768ff64]:last-child {\\n  margin-bottom: 0;\\n}\\n@-webkit-keyframes blink {\\n  0% {\\n    opacity: 1;\\n  }\\n  50% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\\n@keyframes blink {\\n  0% {\\n    opacity: 1;\\n  }\\n  50% {\\n    opacity: 0;\\n  }\\n  100% {\\n    opacity: 1;\\n  }\\n}\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=0!./src/industrywar/pages/scene/scene.vue\n ** module id = 205\n ** module chunks = 7\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./scene.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./scene.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../../../node_modules/css-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./../../../../node_modules/stylus-loader/index.js?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./scene.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"extract\":true,\"remove\":true}!./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!./~/stylus-loader?sourceMap!./~/vue-loader/lib/selector.js?type=style&index=0!./src/industrywar/pages/scene/scene.vue\n ** module id = 228\n ** module chunks = 7\n **/","module.exports = \"<div _v-e768ff64=\\\"\\\"><div :style=\\\"{backgroundImage:'url('+bgImage+')'}\\\" class=\\\"main background\\\" _v-e768ff64=\\\"\\\"></div><div :style=\\\"{backgroundImage:'url(/static/npc.png)'}\\\" class=\\\"main foreground\\\" _v-e768ff64=\\\"\\\"></div><div class=\\\"ui top fixed transparent icon menu\\\" _v-e768ff64=\\\"\\\"><a @click=exit class=item _v-e768ff64=\\\"\\\"><i class=\\\"ui chevron left icon\\\" _v-e768ff64=\\\"\\\"></i></a><div class=\\\"right menu\\\" _v-e768ff64=\\\"\\\"><div class=item _v-e768ff64=\\\"\\\"><i class=\\\"info icon\\\" _v-e768ff64=\\\"\\\"></i></div></div></div><div @click=dialogClicked class=\\\"ui dialog segment\\\" _v-e768ff64=\\\"\\\"><div class=\\\"ui container\\\" _v-e768ff64=\\\"\\\"><h1 _v-e768ff64=\\\"\\\">新手向导</h1><p v-show=current.typing class=\\\"scene string\\\" _v-e768ff64=\\\"\\\"><span class=typing _v-e768ff64=\\\"\\\"></span></p><p v-show=!current.typing class=\\\"finished string\\\" _v-e768ff64=\\\"\\\"><span _v-e768ff64=\\\"\\\">{{ current.string }}</span></p></div></div><div transition=semantic v-show=current.isChoosing class=\\\"ui choices scale transition\\\" _v-e768ff64=\\\"\\\"><div class=\\\"ui middle aligned center aligned padded grid\\\" _v-e768ff64=\\\"\\\"><div class=column _v-e768ff64=\\\"\\\"><div class=\\\"ui segment\\\" _v-e768ff64=\\\"\\\"><button v-for=\\\"choice in current.choices\\\" @click=doAction(choice.action) class=\\\"big ui fluid button\\\" _v-e768ff64=\\\"\\\">{{ choice.title }}</button></div></div></div></div></div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-rewriter.js?id=_v-e768ff64!./~/vue-loader/lib/template-loader.js?raw&engine=jade!./~/vue-loader/lib/selector.js?type=template&index=0!./src/industrywar/pages/scene/scene.vue\n ** module id = 268\n ** module chunks = 7\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-e768ff64&scoped=true!stylus-loader?sourceMap!./../../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./scene.vue\")\n__vue_script__ = require(\"!!coffee!./../../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./scene.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../../../node_modules/vue-loader/lib/template-rewriter.js?id=_v-e768ff64!./../../../../node_modules/vue-loader/lib/template-loader.js?raw&engine=jade!./../../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./scene.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/industrywar/pages/scene/scene.vue\n ** module id = 281\n ** module chunks = 7\n **/"],"sourceRoot":""}